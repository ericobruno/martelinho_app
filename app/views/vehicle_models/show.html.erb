<div class="row mb-4">
  <div class="col-12">
    <div class="d-flex justify-content-between align-items-center">
      <h1 class="h2 mb-0">
        <i class="fas fa-car text-primary"></i>
        <%= @vehicle_model.name %>
      </h1>
      <div class="d-flex gap-2">
        <%= link_to "Editar", edit_vehicle_model_path(@vehicle_model), 
            class: "btn btn-warning" %>
        <%= link_to "Voltar", vehicle_models_path, class: "btn btn-secondary" %>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-lg-8">
    <!-- Model Information -->
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fas fa-info-circle"></i>
          Informações do Modelo
        </h5>
      </div>
      <div class="card-body">
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label text-muted">Nome do Modelo</label>
            <p class="fw-semibold"><%= @vehicle_model.name %></p>
          </div>
          
          <div class="col-md-6">
            <label class="form-label text-muted">Marca</label>
            <p>
              <%= link_to @vehicle_model.vehicle_brand.name, @vehicle_model.vehicle_brand,
                  class: "text-decoration-none fw-semibold" %>
            </p>
          </div>
          
          <div class="col-md-3">
            <label class="form-label text-muted">Status</label>
            <p>
              <% if @vehicle_model.active? %>
                <span class="badge bg-success">
                  <i class="fas fa-check"></i> Ativo
                </span>
              <% else %>
                <span class="badge bg-secondary">
                  <i class="fas fa-times"></i> Inativo
                </span>
              <% end %>
            </p>
          </div>
          
          <div class="col-md-3">
            <label class="form-label text-muted">Ano Inicial</label>
            <p class="fw-semibold"><%= @vehicle_model.initial_year %></p>
          </div>
          
          <div class="col-md-3">
            <label class="form-label text-muted">Ano Final</label>
            <p class="fw-semibold">
              <%= @vehicle_model.final_year.present? ? @vehicle_model.final_year : "Atual" %>
            </p>
          </div>
          
          <div class="col-md-3">
            <label class="form-label text-muted">Criado em</label>
            <p><%= l @vehicle_model.created_at, format: :short %></p>
          </div>
        </div>
      </div>
    </div>

    <!-- Associated Vehicles -->
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">
          <i class="fas fa-car"></i>
          Veículos deste Modelo
        </h5>
        <%= link_to "Ver Todos", vehicles_path(model_id: @vehicle_model.id), 
            class: "btn btn-sm btn-outline-primary" %>
      </div>
      <div class="card-body p-0">
        <% if @vehicle_model.vehicles.any? %>
          <div class="table-responsive">
            <table class="table table-hover mb-0">
              <thead class="table-light">
                <tr>
                  <th>Placa</th>
                  <th>Cliente</th>
                  <th>Ano</th>
                  <th>Cor</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody>
                <% @vehicle_model.vehicles.includes(:customer).limit(10).each do |vehicle| %>
                  <tr>
                    <td class="fw-bold"><%= vehicle.license_plate %></td>
                    <td>
                      <%= link_to vehicle.customer.name, vehicle.customer,
                          class: "text-decoration-none" %>
                    </td>
                    <td><%= vehicle.year %></td>
                    <td><%= vehicle.color %></td>
                    <td>
                      <div class="btn-group" role="group">
                        <%= link_to vehicle, class: "btn btn-sm btn-outline-primary",
                            title: "Ver veículo" do %>
                          <i class="fas fa-eye"></i>
                        <% end %>
                        
                        <%= link_to edit_vehicle_path(vehicle), 
                            class: "btn btn-sm btn-outline-warning",
                            title: "Editar veículo" do %>
                          <i class="fas fa-edit"></i>
                        <% end %>
                      </div>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
          
          <% if @vehicle_model.vehicles.count > 10 %>
            <div class="card-footer text-center">
              <small class="text-muted">
                Mostrando 10 de <%= @vehicle_model.vehicles.count %> veículos
              </small>
            </div>
          <% end %>
        <% else %>
          <div class="text-center py-5">
            <i class="fas fa-car fa-2x text-muted mb-3"></i>
            <h6 class="text-muted">Nenhum veículo cadastrado</h6>
            <p class="text-muted mb-3">
              Ainda não há veículos cadastrados para este modelo.
            </p>
            <%= link_to "Cadastrar Veículo", new_vehicle_path(model_id: @vehicle_model.id), 
                class: "btn btn-sm btn-primary" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Sidebar -->
  <div class="col-lg-4">
    <!-- Actions -->
    <div class="card mb-4">
      <div class="card-header">
        <h6 class="mb-0">
          <i class="fas fa-cogs"></i>
          Ações
        </h6>
      </div>
      <div class="card-body">
        <div class="d-grid gap-2">
          <%= link_to "Editar Modelo", edit_vehicle_model_path(@vehicle_model), 
              class: "btn btn-warning" %>
          
          <%= link_to "Ver Marca", @vehicle_model.vehicle_brand, 
              class: "btn btn-outline-primary" %>
          
          <%= link_to "Listar Modelos", vehicle_models_path, 
              class: "btn btn-outline-secondary" %>
          
          <%= link_to "Cadastrar Veículo", new_vehicle_path(model_id: @vehicle_model.id), 
              class: "btn btn-success" %>
          
          <hr>
          
          <%= link_to "Excluir Modelo", @vehicle_model, method: :delete,
              class: "btn btn-danger",
              confirm: "Tem certeza que deseja excluir o modelo #{@vehicle_model.name}? Esta ação não pode ser desfeita." %>
        </div>
      </div>
    </div>

    <!-- Statistics -->
    <div class="card">
      <div class="card-header">
        <h6 class="mb-0">
          <i class="fas fa-chart-bar"></i>
          Estatísticas
        </h6>
      </div>
      <div class="card-body">
        <div class="row text-center">
          <div class="col-6">
            <h4 class="text-primary mb-1"><%= @vehicle_model.vehicles.count %></h4>
            <small class="text-muted">Veículos</small>
          </div>
          <div class="col-6">
            <h4 class="text-success mb-1"><%= @vehicle_model.vehicles.joins(:quotes).distinct.count %></h4>
            <small class="text-muted">Com Orçamentos</small>
          </div>
        </div>
        
        <hr>
        
        <div class="row text-center">
          <div class="col-12">
            <h5 class="text-info mb-1"><%= time_ago_in_words(@vehicle_model.created_at) %></h5>
            <small class="text-muted">Criado há</small>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> 